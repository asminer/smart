#!/bin/bash

#
# $Id$
#
# Builds the revision number.
#

rev=`svn info | awk '/Revision/{print $2}'`
if [ -z "$rev" ]; then
  if [ -e revision.h ]; then
    printf "Leaving old revision number\n"
  else
    printf "Using bogus revision number\n";
    printf "const int REVISION_NUMBER = 0 ;\n" > revision.h
  fi
else
  if [ -e revision.h ]; then
    revlast=`awk '{print $5}' revision.h`
    if [ "$rev" -eq "$revlast" ]; then
      printf "No revision number change since last build\n";
    else
      printf "Updating revision number to %d\n" $rev
      printf "const int REVISION_NUMBER = $rev ;\n" > revision.h
    fi
  else
    printf "Updating revision number to %d\n" $rev
    printf "const int REVISION_NUMBER = $rev ;\n" > revision.h
  fi
fi

